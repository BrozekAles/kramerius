<!DOCTYPE html>
<html>

#parse("profile.vm")
#parse("logingoptions.vm")


#if ($params.exists( "page" )) 
#parse("new-sitemap.vm")
#parse($site.Map.get($params.page))
#else
    #parse("new-home.vm")
#end



    <script language="JavaScript" type="text/javascript">
        
        $(document).ready(function() {
	    // Initializing application	
	    K5.init({
                // selected language
                "language":'$i18n.language', 
                "country":'$i18n.country',
                
                
                // home page check
                #if(!$params.page) "page":'home',
                #else "page":'$params.page',  #end
               
                //user and profile
                #if($logControl.logged)"user": $logControl.userJSONRepresentation, #end
                #if($logControl.profileRetrieved)"profile": $logControl.profileJSONRepresentation, #end

                // session controls
                "session":$sessionControl.sessionFieldsJSONRepresentation,  
                
                //selected configurations 
                "conf": {
                    "i18n" :{
                        "cdkSources":$conf.getString('cdkSources')
                    },
                    "pdf":{
                        #if(!$conf.getBoolean('turnOffPdfCheck'))
                            "limit":$conf.getString('generatePdfMaxRange')
                         #end

                     },
                    "authentication":{
                        "k5":true, #if($conf.getString('oauth.googleapis.com.consumer_key')) "gplus":true, #else "gplus":false, #end #if($conf.getString('oauth.graph.facebook.com.consumer_key')) "fb":true #else "fb":false #end

                    },
                    "index": $conf.indexConfig
                },
                
                // definitions
                "defs": {
                    "downloadoptions":$fmap.downloadsDefinitions,
                    "shareoptions":$fmap.shareDefinitions,
                    "viewers": $fmap.viewersDefinitions
                }
            });
        });

        $(window).resize(function() {
            $(".resizable").trigger("wresize");
        });
        
    </script>

</html>